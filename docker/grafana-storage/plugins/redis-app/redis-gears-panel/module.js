/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","@grafana/runtime","@emotion/css"],(function(e,t,n,r,o){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=10)}([function(t,n){t.exports=e},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return f}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function c(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}Object.create;function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function s(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||t)}function f(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}Object.create},function(e,n){e.exports=t},function(e,t,n){e.exports=n(7)()},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){"use strict";var r=n(8);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},,function(e,t,n){"use strict";n.r(t);var r=n(4),o=n(1),i=n(0),a=n.n(i),c=n(2);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}function b(e){return function t(){for(var n=this,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.apply(n,[].concat(o,r))}}}function m(e){return{}.toString.call(e).includes("Object")}function y(e){return"function"==typeof e}var v=b((function(e,t){throw new Error(e[t]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),O={changes:function(e,t){return m(t)||v("changeType"),Object.keys(t).some((function(t){return n=e,r=t,!Object.prototype.hasOwnProperty.call(n,r);var n,r}))&&v("changeField"),t},selector:function(e){y(e)||v("selectorType")},handler:function(e){y(e)||m(e)||v("handlerType"),m(e)&&Object.values(e).some((function(e){return!y(e)}))&&v("handlersType")},initial:function(e){var t;e||v("initialIsRequired"),m(e)||v("initialType"),t=e,Object.keys(t).length||v("initialContent")}};function j(e,t){return y(t)?t(e.current):t}function w(e,t){return e.current=g(g({},e.current),t),t}function M(e,t,n){return y(t)?t(e.current):Object.keys(n).forEach((function(n){var r;return null===(r=t[n])||void 0===r?void 0:r.call(t,e.current[n])})),n}var E={create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};O.initial(e),O.handler(t);var n={current:e},r=b(M)(n,t),o=b(w)(n),i=b(O.changes)(e),a=b(j)(n);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return O.selector(e),e(n.current)}function u(e){h(r,o,i,a)(e)}return[c,u]}},k={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.25.0/min/vs"}};var S=function(e){return{}.toString.call(e).includes("Object")};var R=function(e){return function t(){for(var n=this,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.apply(n,[].concat(o,r))}}}((function(e,t){throw new Error(e[t]||e.default)}))({configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "}),P={config:function(e){return e||R("configIsRequired"),S(e)||R("configType"),e.urls?{paths:{vs:e.urls.monacoBase}}:e}},C=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}};var T=function e(t,n){return Object.keys(n).forEach((function(r){n[r]instanceof Object&&t[r]&&Object.assign(n[r],e(t[r],n[r]))})),s(s({},t),n)},x={type:"cancelation",msg:"operation is manually canceled"};var N,_,q=function(e){var t=!1,n=new Promise((function(n,r){e.then((function(e){return t?r(x):n(e)})),e.catch(r)}));return n.cancel=function(){return t=!0},n},D=E.create({config:k,isInitialized:!1,resolve:null,reject:null,monaco:null}),I=(_=2,function(e){if(Array.isArray(e))return e}(N=D)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(N,_)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(N,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),L=I[0],V=I[1];function A(e){return document.body.appendChild(e)}function U(e){var t,n,r=L((function(e){return{config:e.config,reject:e.reject}})),o=(t="".concat(r.config.paths.vs,"/loader.js"),n=document.createElement("script"),t&&(n.src=t),n);return o.onload=function(){return e()},o.onerror=r.reject,o}function B(){var e=L((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],(function(t){F(t),e.resolve(t)}),(function(t){e.reject(t)}))}function F(e){L().monaco||V({monaco:e})}var W=new Promise((function(e,t){return V({resolve:e,reject:t})})),H={config:function(e){V((function(t){return{config:T(t.config,P.config(e))}}))},init:function(){if(!L((function(e){return{isInitialized:e.isInitialized}})).isInitialized){if(window.monaco&&window.monaco.editor)return F(window.monaco),q(Promise.resolve(window.monaco));C(A,U)(B),V({isInitialized:!0})}return q(W)},__getMonacoInstance:function(){return L((function(e){return e.monaco}))}},z=n(3),Q=n.n(z);const G={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var Y=function({content:e}){return a.a.createElement("div",{style:G},e)};var K={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function $({width:e,height:t,isEditorReady:n,loading:r,_ref:o,className:i,wrapperClassName:c}){return a.a.createElement("section",{style:{...K.wrapper,width:e,height:t},className:c},!n&&a.a.createElement(Y,{content:r}),a.a.createElement("div",{ref:o,style:{...K.fullWidth,...!n&&K.hide},className:i}))}$.propTypes={width:Q.a.oneOfType([Q.a.number,Q.a.string]).isRequired,height:Q.a.oneOfType([Q.a.number,Q.a.string]).isRequired,loading:Q.a.oneOfType([Q.a.element,Q.a.string]).isRequired,isEditorReady:Q.a.bool.isRequired,className:Q.a.string,wrapperClassName:Q.a.string};var J=$,X=Object(i.memo)(J);var Z=function(e){Object(i.useEffect)(e,[])};var ee=function(e,t,n=!0){const r=Object(i.useRef)(!0);Object(i.useEffect)(r.current||!n?()=>{r.current=!1}:e,t)};function te(){}function ne(e,t,n,r){return function(e,t){return e.editor.getModel(re(e,t))}(e,r)||function(e,t,n,r){return e.editor.createModel(t,n,r&&re(e,r))}(e,t,n,r)}function re(e,t){return e.Uri.parse(t)}function oe({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:o,originalModelPath:c,modifiedModelPath:u,keepCurrentOriginalModel:l,keepCurrentModifiedModel:s,theme:f,loading:d,options:p,height:g,width:h,className:b,wrapperClassName:m,beforeMount:y,onMount:v}){const[O,j]=Object(i.useState)(!1),[w,M]=Object(i.useState)(!0),E=Object(i.useRef)(null),k=Object(i.useRef)(null),S=Object(i.useRef)(null),R=Object(i.useRef)(v),P=Object(i.useRef)(y);Z(()=>{const e=H.init();return e.then(e=>(k.current=e)&&M(!1)).catch(e=>"cancelation"!==(null==e?void 0:e.type)&&void 0),()=>E.current?function(){const e=E.current.getModel();var t,n;l||null===(t=e.original)||void 0===t||t.dispose();s||null===(n=e.modified)||void 0===n||n.dispose();E.current.dispose()}():e.cancel()}),ee(()=>{const e=E.current.getModifiedEditor();e.getOption(k.current.editor.EditorOption.readOnly)?e.setValue(t):t!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:t,forceMoveMarkers:!0}]),e.pushUndoStop())},[t],O),ee(()=>{E.current.getModel().original.setValue(e)},[e],O),ee(()=>{const{original:e,modified:t}=E.current.getModel();k.current.editor.setModelLanguage(e,r||n),k.current.editor.setModelLanguage(t,o||n)},[n,r,o],O),ee(()=>{k.current.editor.setTheme(f)},[f],O),ee(()=>{E.current.updateOptions(p)},[p],O);const C=Object(i.useCallback)(()=>{P.current(k.current);const i=k.current.editor.createModel(e,r||n,c&&k.current.Uri.parse(c)),a=k.current.editor.createModel(t,o||n,u&&k.current.Uri.parse(u));E.current.setModel({original:i,modified:a})},[n,t,o,e,r,c,u]),T=Object(i.useCallback)(()=>{E.current=k.current.editor.createDiffEditor(S.current,{automaticLayout:!0,...p}),C(),k.current.editor.setTheme(f),j(!0)},[p,f,C]);return Object(i.useEffect)(()=>{O&&R.current(E.current,k.current)},[O]),Object(i.useEffect)(()=>{!w&&!O&&T()},[w,O,T]),a.a.createElement(X,{width:h,height:g,isEditorReady:O,loading:d,_ref:S,className:b,wrapperClassName:m})}oe.propTypes={original:Q.a.string,modified:Q.a.string,language:Q.a.string,originalLanguage:Q.a.string,modifiedLanguage:Q.a.string,originalModelPath:Q.a.string,modifiedModelPath:Q.a.string,keepCurrentOriginalModel:Q.a.bool,keepCurrentModifiedModel:Q.a.bool,theme:Q.a.string,loading:Q.a.oneOfType([Q.a.element,Q.a.string]),options:Q.a.object,width:Q.a.oneOfType([Q.a.number,Q.a.string]),height:Q.a.oneOfType([Q.a.number,Q.a.string]),className:Q.a.string,wrapperClassName:Q.a.string,beforeMount:Q.a.func,onMount:Q.a.func},oe.defaultProps={theme:"light",loading:"Loading...",options:{},keepCurrentOriginalModel:!1,keepCurrentModifiedModel:!1,width:"100%",height:"100%",beforeMount:te,onMount:te};var ie=function(e){const t=Object(i.useRef)();return Object(i.useEffect)(()=>{t.current=e},[e]),t.current};const[ae,ce]=E.create({backup:null}),ue=new Map;function le({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:o,path:c,theme:u,line:l,loading:s,options:f,overrideServices:d,saveViewState:p,keepCurrentModel:g,width:h,height:b,className:m,wrapperClassName:y,beforeMount:v,onMount:O,onChange:j,onValidate:w}){const[M,E]=Object(i.useState)(!1),[k,S]=Object(i.useState)(!0),R=Object(i.useRef)(null),P=Object(i.useRef)(null),C=Object(i.useRef)(null),T=Object(i.useRef)(O),x=Object(i.useRef)(v),N=Object(i.useRef)(null),_=Object(i.useRef)(r),q=ie(c);Z(()=>{const e=H.init();return e.then(e=>(R.current=e)&&S(!1)).catch(e=>"cancelation"!==(null==e?void 0:e.type)&&void 0),()=>P.current?function(){var e,t;null===(e=N.current)||void 0===e||e.dispose(),g?p&&ue.set(c,P.current.saveViewState()):null===(t=P.current.getModel())||void 0===t||t.dispose();P.current.dispose()}():e.cancel()}),ee(()=>{const n=ne(R.current,e||r,t||o,c);n!==P.current.getModel()&&(p&&ue.set(q,P.current.saveViewState()),P.current.setModel(n),p&&P.current.restoreViewState(ue.get(c)))},[c],M),ee(()=>{P.current.updateOptions(f)},[f],M),ee(()=>{P.current.getOption(R.current.editor.EditorOption.readOnly)?P.current.setValue(r):r!==P.current.getValue()&&(P.current.executeEdits("",[{range:P.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),P.current.pushUndoStop())},[r],M),ee(()=>{R.current.editor.setModelLanguage(P.current.getModel(),o)},[o],M),ee(()=>{void 0!==l&&P.current.revealLine(l)},[l],M),ee(()=>{R.current.editor.setTheme(u)},[u],M);const D=Object(i.useCallback)(()=>{x.current(R.current);const i=c||n,a=ne(R.current,r||e,t||o,i);P.current=R.current.editor.create(C.current,{model:a,automaticLayout:!0,...f},d),p&&P.current.restoreViewState(ue.get(i)),R.current.editor.setTheme(u),ae().backup||ce({backup:R.current.editor.setModelMarkers}),E(!0)},[e,t,n,r,o,c,f,d,p,u]);return Object(i.useEffect)(()=>{M&&T.current(P.current,R.current)},[M]),Object(i.useEffect)(()=>{!k&&!M&&D()},[k,M,D]),_.current=r,Object(i.useEffect)(()=>{var e,t;M&&j&&(null===(e=N.current)||void 0===e||e.dispose(),N.current=null===(t=P.current)||void 0===t?void 0:t.onDidChangeModelContent(e=>{const t=P.current.getValue();_.current!==t&&j(t,e)}))},[M,j]),Object(i.useEffect)(()=>{M&&(R.current.editor.setModelMarkers=function(e,t,n){var r;null===(r=ae().backup)||void 0===r||r.call(R.current.editor,e,t,n),null==w||w(n)})},[M,w]),a.a.createElement(X,{width:h,height:b,isEditorReady:M,loading:s,_ref:C,className:m,wrapperClassName:y})}le.propTypes={defaultValue:Q.a.string,defaultPath:Q.a.string,defaultLanguage:Q.a.string,value:Q.a.string,language:Q.a.string,path:Q.a.string,theme:Q.a.string,line:Q.a.number,loading:Q.a.oneOfType([Q.a.element,Q.a.string]),options:Q.a.object,overrideServices:Q.a.object,saveViewState:Q.a.bool,keepCurrentModel:Q.a.bool,width:Q.a.oneOfType([Q.a.number,Q.a.string]),height:Q.a.oneOfType([Q.a.number,Q.a.string]),className:Q.a.string,wrapperClassName:Q.a.string,beforeMount:Q.a.func,onMount:Q.a.func,onChange:Q.a.func,onValidate:Q.a.func},le.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",beforeMount:te,onMount:te,onValidate:te};var se,fe=le,de=Object(i.memo)(fe),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.width,r=t.height,o=t.theme,i=t.showMiniMap,c=t.showLineNumbers,u=t.language,l=void 0===u?"python":u,s=t.onChange,f={wordWrap:"off",codeLens:!1,minimap:{enabled:i,renderCharacters:!1},readOnly:!!t.readOnly,lineNumbersMinChars:4,lineDecorationsWidth:0,overviewRulerBorder:!1,automaticLayout:!0};return c||(f.glyphMargin=!1,f.folding=!1,f.lineNumbers="off",f.lineDecorationsWidth=5,f.lineNumbersMinChars=0),a.a.createElement(de,{width:n,height:r,theme:o.isDark?"vs-dark":"vs-light",onChange:s,language:l,options:f,value:null!==(e=this.props.value)&&void 0!==e?e:""})},t}(i.PureComponent),ge=Object(c.withTheme)(pe),he=n(6),be=n(5);!function(e){e[e.Blocking=0]="Blocking",e[e.Unblocking=1]="Unblocking"}(se||(se={}));var me,ye,ve,Oe=[{label:"Blocking",value:se.Blocking},{label:"Unblocking",value:se.Unblocking}],je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={script:"gb = GearsBuilder()",unblocking:!1,requirements:"",isRunning:!1,footerHeight:0,error:null},t.footerRef=Object(i.createRef)(),t.onChangeScript=function(e){void 0===e&&(e=""),t.setState({script:e})},t.onRunScript=function(){return Object(o.b)(t,void 0,void 0,(function(){var e,t,n,i;return Object(o.d)(this,(function(o){switch(o.label){case 0:return this.setState({isRunning:!0,error:null}),[4,this.makeQuery()];case 1:return(e=o.sent())&&e.state!==r.LoadingState.Error&&e.data.length?(t=e.data[1])&&t.length>0?(n=t.fields[0].values.toArray(),this.setState({result:void 0,isRunning:!1,error:Object(be.toDataQueryError)({message:n[0]})}),[2]):(0===(i=e.data[0]).length&&(i=Object(r.toDataFrame)({fields:[{name:"results",type:r.FieldType.string,values:["OK"]}]})),i.fields.forEach((function(e){e.display=Object(r.getDisplayProcessor)({field:e,theme:be.config.theme2})})),this.setState({result:i,isRunning:!1}),[2]):(this.setState({result:void 0,isRunning:!1,error:Object(be.toDataQueryError)((null==e?void 0:e.error)||{message:"Common error"})}),[2])}}))}))},t.onChangeUnblocking=function(e){t.setState({unblocking:!!e})},t.onChangeRequirements=function(e){t.setState({requirements:e.target.value})},t.onClearError=function(){t.setState({error:null})},t}return Object(o.c)(t,e),t.prototype.componentDidMount=function(){this.footerRef.current&&this.setState({footerHeight:this.footerRef.current.getBoundingClientRect().height})},t.prototype.componentDidUpdate=function(e,t){e.width===this.props.width&&t.result===this.state.result&&t.error===this.state.error||this.footerRef.current&&this.setState({footerHeight:this.footerRef.current.getBoundingClientRect().height})},t.prototype.makeQuery=function(){var e;return Object(o.b)(this,void 0,Promise,(function(){var t,n,r,i,a=this;return Object(o.d)(this,(function(c){switch(c.label){case 0:return t=(null===(e=this.props.data.request)||void 0===e?void 0:e.targets)||[],n="",t&&t.length&&t[0].datasource&&(n=t[0].datasource),n?(r=t.map((function(e){return Object(o.a)(Object(o.a)({},e),{command:"rg.pyexecute",keyName:a.state.script,unblocking:a.state.unblocking,requirements:a.state.requirements})})),[4,Object(be.getDataSourceSrv)().get(n)]):[2,Promise.resolve(null)];case 1:return i=c.sent(),[2,i.query(Object(o.a)(Object(o.a)({},this.props.data.request),{targets:r})).toPromise()]}}))}))},t.prototype.render=function(){var e=this.props,t=e.height,n=e.width,r=this.state,i=r.script,u=r.result,l=r.unblocking,s=r.requirements,f=r.isRunning,d=r.footerHeight,p=r.error;return a.a.createElement("div",{className:Object(he.css)(me||(me=Object(o.e)(["\n          position: relative;\n        "],["\n          position: relative;\n        "])))},a.a.createElement("div",{className:Object(he.css)(ye||(ye=Object(o.e)(["\n            margin-bottom: 4px;\n          "],["\n            margin-bottom: 4px;\n          "])))},a.a.createElement(ge,{value:i,language:"python",width:n,height:t-d,onChange:this.onChangeScript,showMiniMap:!0,showLineNumbers:!0})),a.a.createElement("div",{ref:this.footerRef},p&&p.message&&a.a.createElement(c.Alert,{title:p.message,onRemove:this.onClearError}),a.a.createElement("div",{className:"gf-form"},a.a.createElement(c.InlineField,{label:a.a.createElement(c.InlineFormLabel,{width:6},"Requirements")},a.a.createElement(c.Input,{css:"",value:s,onChange:this.onChangeRequirements,width:40})),a.a.createElement(c.RadioButtonGroup,{className:Object(he.css)(ve||(ve=Object(o.e)(["\n                margin-right: 4px;\n              "],["\n                margin-right: 4px;\n              "]))),value:l?se.Unblocking:se.Blocking,options:Oe,onChange:this.onChangeUnblocking}),a.a.createElement(c.Button,{onClick:this.onRunScript,disabled:f},f?"Running...":"Run script")),u&&a.a.createElement(a.a.Fragment,null,a.a.createElement("hr",null),a.a.createElement(c.Table,{noHeader:!0,data:u,width:n,height:100}))))},t}(i.PureComponent);n.d(t,"plugin",(function(){return we}));var we=new r.PanelPlugin(je)}])}));
//# sourceMappingURL=module.js.map